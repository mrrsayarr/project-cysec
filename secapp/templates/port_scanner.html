{% extends "base.html" %}

{% block title %}
Port Scan
{% endblock %}

{% block content %}

<div class="container-fluid pt-4 px-4">
    <form method="post" id="scanForm" onsubmit="return false;">
        {% csrf_token %}
        <div class="form-group">
            <label for="ip_address">IP Address:</label>
            <input type="text" id="ip_address" value="45.33.32.156" name="ip_address" class="form-control bg-white">
        </div>
        <div class="form-group">
            <label for="port_min">Starting Port:</label>
            <input type="number" id="port_min" name="port_min" min="1" max="65535" value="1"
                class="form-control bg-white">
        </div>
        <div class="form-group">
            <label for="port_max">Ending Port:</label>
            <input type="number" id="port_max" name="port_max" min="1" max="65535" value="10"
                class="form-control bg-white">
        </div>
        <button type="button" id="submitBtn" class="btn btn-primary mt-2 mb-2">Submit</button>
    </form>

    <div id="loadingSpinner" class="spinner-border text-primary" style="display: none;"></div>

    <div id="results"></div>

    <!-- <iframe src="{% url 'port_results' %}" frameborder="0" width="100%" height="500"></iframe> -->
</div>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
<script>
    $(document).ready(function () {
        $('#submitBtn').on('click', function () {
            $('#loadingSpinner').show();
            $.ajax({
                url: '/port_scanner/',
                type: 'post',
                data: $('#scanForm').serialize(),
                success: function (data) {
                    $('#loadingSpinner').hide();
                    // AJAX isteği başarılı olduğunda yönlendirme yap
                    window.location.href = "{% url 'port_results' %}";
                }
            });
        });
    });
</script>

{% endblock %}